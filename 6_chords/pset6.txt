
Pomo 1: 9:03 -- 9:28
Goal: Exercises 1 and 2

Unsure about the indexing of the chords
The chords are horizontal
 For some reason centered on 0

Want to do conversion 
 make so get array of nonzero indices
 problem is that need to operate on 
 used np.where and [1]

Need conversion from note num to name
 look in labs
 Ended up writing by hand
 Now translating to note names

out of time

Pomo 2: 9:31 - 9:56
Goal: Ex 1 and 2

First step - translate to note names
 vectorize the dict call
 worked
Ex 1 done
 
Ex 2 -- harmonics_chord_template()

Converted chords to their pitch numbers
Unsure how to make harmonics chord template

Inputs: 
 pitches -- a list of pitches to be included in the chord template
 alpha -- harmonic decay values
 
Do pitches already match up to pitch numbers mod 12?
 What are the units of the pitches that we are using?
 Probably midi pitch 
 A = 69 -- which should be 9 mod 12, so yes
 middle C = 60

Are the pitches coming in just the chord, or also the harmonics?
And the doubling that we are doing, is this in MIDI pitch, or in frequency

Found stuff on piazza

Outputing a length 12 chroma template vectors
 So just for one chord
 So summing over harmonics for each pitch

Out of time

Pomo 3: 10:00 -- 10:25
Goal: Ex 2

May not currently be going into the right bins
picking bin off of pitch % 12, but should be full answer mod 12
Getting out of index error
 For some reason getting very high values in first bin
 Debug by printing which section going to
 Getting many true 0 vals
 Will be for full set of 8
  Must be when the pitch coming in is 0
  All multiples will also be 0
  So the alphas accumulate in 0
 This is not right behavior, as seen in the examples
 C2 --> C3 --> G3 --> C4 --> E4
 If was just multiples, would be all C's
 Maybe it is doubling in actual frequency
 That also make more sense

 But not given an octave for input pitches
  Is this pattern invariant on octave?
  Check for this
 
 Try by doubling in frequency domain in test
 See if get same harmonic pattern as in example

Out of time
Took shower

Pomo 4: 10:55 -- 11:20
Goal: Ex 2 

First test with C2
What midi pitch is C2
C4 == 60 => C2 = 36

C2 -> C3 good
Harmonic 2 -- 55 midi => G3 
Correct

Does octave matter?
No, it doesn't

So how to implement?
Could add values
But then need to do conversion back ...
 Since this is the same, there must be a better way to do this
First is octave, then 5th, the 4, 3,m3,...
Since only 8, could hardcode

Would rather not
What does doubling of frequency correspond to in midi? +12
What about multiple of n
 Write out
Got nice formula, checked

Domain error -- must be using on 0

out of time

Pomo 5: 11:21 --> 11:46
Goal: Ex 2 and get template for ex 3

Erroring on ex 2
math domain error in math.log -- harmonic
Done

Ex 3
Classifier is estimating chords in bach piece
TP black, FN pink, FP red
Getting many false positives during 2nd and 3rd bars

Because well-tuning system
 
Ex 4
make_triads_templates() -- produce chords template matrix w/ 24 rows
So each row is a chord
Start with Major (4,3) and switch to minor (3,4)
[0,4,7] and move 

1st column should be [0,11],[0,11]

What should the magnitudes be?
Probably single row normalized.

Ok, so first do indices
How to convert array of indices per row to chord_templates

Use toy example in python
Having some trouble with the indexing
Feel like there should be a natural way to do this with numpy indexing

Pretty annoying that numpy changes behavior with two indexing lists
 
I don't think that I can do this with standard array indexing

I can do this with np.take, but then can't assign

could do with another array that has the number of the row
[0,0,0,0,0]
[1,1,1,1,1]
...

The above worked, but I was forgetting to use the harmonics, which was the last method
 
Done

Pomo 6: 1:10 --> 1:35
Goal: 5a

Estimate chords of snd

1. create chromagram
2. create score matrix
3. create chord estimates, called est
4. Plot matrix and chord estimates

what is the value of fs

Inner prod not working
Check dimensions -- took transpose 

Success, 
Exercise 5b
 Use fxn from Lab to calculate score of chord estimates
 Shouldn't take long -- explicitly use num correct out of total

Need more than 2 values to unpack from fmp.load_chord_annotation
But only 2 in the examples
The issue was using wrong file

Getting low score, maybe because very different lengths of gt and est

Check ff <-- they should in fact be the same length
Did the lab part

But even in the lab, getting length mismatch

Fix lab nums, then 5b
maybe because est is only part of the song
Turns out that it wasn't asking for an assertion, rather a slice

Done

Pomo: 2:18 -- 2:43
Goal: Exercise 6

tuning values in make_chromagram

Done

Exercise 7
Apply temporal smoothing

Try diff vals of L, and find best value 

Then do with Hanning window instead of rectangular
 modify temporal_smoothing() to do this

Was hanning better?

So first step is to go to lab and do temporal smoothing
Unsure if he kept the indices the same

So look through chords 1 and 2 to see if temporal smoothing
Is same in notes, go with that

step 1 -- lab

Smoothing is separate for each row
 Currently error because trying to do all

Find out what the extension policy is
 Asked zach
 This determines wheter what I should be working on

In any event, be as effitcient as possible
In the grand scale of things
 David Spivak very important

Ok, now work on this

Pomo 5:00 -- 5:25
Goal: Exercise 7 

Start with tuned chromagram from above 
apply temporal smoothing using temporal_smoothing() from lab
Try diff vals of L, and use values that works best for calc_chord_score()
Need to transfer temporal smoothing over
 
Got an answer but the the score is lower than before -- there must be an error 
plot different values of window length

Decent improvement
Now try hanning window

Hanning erroring
 row is empty
 unsure why row now empty

Try testing smaller convolve fxn
Works, so much be outside of temporal_smoothing

Window length is a fraction
Where does window length come from?
 from find_best_smoothing_window
Returning best_tuning still!

Why printing the chroma?
maybe method in make_chromagram
No, in make_triads_templates
Wrote duplicate that is not needed in the interact

Check if alpha value was left out in any call

Still being printed ...
It is the chord_templates
There was a missing s in a variable
 Jupyter persisted that variable ...

Pomo: 6:08 -- 6:33
Goal: Generate markov sequence

First plug in computer

Ok, plan is to generate random sequence of states

Given init_p vector, trans_p matrix, length of sequence to generate
Output array as np.array of ints

Fix invisble cursor
 Must be because of chromium
 Might be because of my theme
 Changed theme to default and restarted chromium
 Fixed -- actually not fixed, removed some addons
 restart again
 Ok now actually fixed
 Actually not fixed, this is too annoying
 For music pset, work in firefox
 
look at np.random.choice
Not taking array instead of list for probabilities
Look at documentation

Fixed by prefacing with p=
But error in object too deep for desired array

There is probably a way to do this without the loop
Look more carefully at optional input p

Have 10 minutes before lecture starts

May be able to figure out how to do the markov here
 Open up just python and docs

Good, now throwing error that a and p must be the same size
So p is in fact selecting probabilities for selecting each value of a 
Hwo can I use this to prevent iterating
 
because need to get probabilities that are based on the last state
what does the A**2 represent, where A is the transition matrix

Remember the picture that A is the linear transformation on x+y+z... = 1
It transforms some probabilities of being in each state to other probabilities of being in each state

so the intial condition probabilities do in fact matter, because the way that the markov moves it around

Pomo: 12:05 -- 12:30
Goal: Exercise 8, shell of 9

T stands for the transformation that takes current probs to new probs of being in each state
T**n stands for the trans that takes current probs to nth next probs
But if I am actually observing the state, then then the column vector becomes [1,0,0]

Issue was just that there were extra brackets around slice of transition array
Done

Ex 9
C, A, B <-- for hidden markov model

write make_simple_trans_probs to create A
A = transition model from HMM with I = 24 states (12 maj and 12 min)

First step -- figure out how to manhattan norm -- see lab
Done

10a
Code provided sets up and performs HMM estimation
Input: chromagram and A

Run the estimator w/ tuned chomagram

Done, submitted Pset



